from math import isqrt

p = 649663831
alpha = 295850
beta = 56181604

cipher_pairs = [
(131703884,288440011),(239233456,242185851),(191002869,324758083),
(354586862,573546143),(51695112,358077124),(387394270,348385237),
(446723598,180154874),(243525338,128301060),(243156727,342367770),
(169911630,250967449),(380629621,11989018),(364206335,47738855),
(135902742,44530683),(584784790,76715784),(583446475,282480103),
(55477948,426367976),(443357837,437693779),(251589203,106832774),
(564290014,17469566),(286021954,525252612),(604021612,248737636),
(90001638,39953594),(445305492,386415239),(16890240,410016323),
(587366957,280061962),(509234516,478080254),(20171111,551337309),
(87098294,647388312),(532270339,160243412),(316992546,509120806),
(338241579,292889668),(601310309,15974713),(73670718,287071489),
(152160231,610083931),(143685499,236870359),(468223468,433842857),
(333959951,433812942),(296313762,390402831),(83587968,442165718),
(38978236,399981698),(470754179,431859735),(399840425,231917057),
(47700532,18959310),(303636426,436914492),(212176825,244913020),
(66389809,127962422),(648488291,648196485),(549087822,419539598),
(49026034,583427763),(115275482,115698539),(561506278,365795886),
(604796421,235836907),(548358670,631553737),(203186962,118668675),
(211188666,228937366),(176560071,524082009),(621137578,331593395),
(522255356,556938913),(433789588,488964339),(274298422,454088855),
(24403118,23855223),(149102962,644165608),(620008709,537792519),
(56465536,219260092),(343648090,161484160),(349847620,374236374),
(90481786,72729373),(68759878,130327743),(164391885,346933328),
(64161071,227260020),(374504909,393980878),(193366775,162730502),
(465585056,582365946),(395707,74325634),(414440254,103685646),
(106279234,460840182),(455387819,257924416),(631024684,605189277),
(530948034,481817898),(7785896,77041640),(196289629,163549997),
(353834745,318191959),(28849443,483293608),(16935899,597013255),
(333023075,334697553),(321536966,375979592),(571557484,330261449),
(165702321,44527169),(251480383,329973765),(92750359,183259829),
(204593288,203402732),(583795176,165799828),(388571199,366398089),
(368276367,41414893),(407484928,69583674),(235458286,648295408),
(152570110,356958157),(72048954,132543439),(121028103,429460316),
(156469907,289859589),(496587118,134741436),(38348987,302138717),
(355335499,627733644),(45462830,4642973),(151313878,165319652),
(365994402,316356701),(539808792,449442029),(105248431,25706554),
(490620748,412440753),(544841019,265436996),(305750887,151049026),
(480654901,463542447),(503434741,172193819),(569840711,235691619),
(336370559,462156131),(171199614,470470897),(76800949,264844256),
(151486615,227050072),(368373866,210578421),(330496047,360029147),
(313996052,100458219),(256546795,395420689),(436828755,573832704),
(201003456,146325901),(601777546,235884677),(550888053,102460441),
(32086722,22504227),(179664363,180405860),(74511454,470629389),
(622601222,309825061),(260716327,187008712),(151207580,477429323),
(233116094,600781842),(526762597,177115486),(557365590,597026062),
(614105085,159756306),(36350153,75169937),(219842599,372432767),
(239980557,322807782),(32622090,145732678),(19629371,211018064),
(371980767,342554481),(449469645,332123158),(546612739,446880974),
(548818989,165731158),(627089810,4572832),(345512738,292171609),
(274816528,16957949),(21982261,316666096),(117102315,491003379),
(432603298,307404303),(380050175,417338458),(291017609,377957875),
(486633509,539028702),(336428936,452889897),(544783211,404427099),
(381593076,573050892),(534159396,478222721),(402817015,48592441),
(271475245,533101920),(449944190,406626009),(378115780,11991919),
(327624179,71518929),(295503513,460686566),(413586417,215833583),
(521877939,205886709)
]

def baby_step_giant_step(g, h, p):
    n = p - 1                   
    m = isqrt(n) + 1
    baby = {}
    cur = 1
    for j in range(m):
        if cur not in baby:
            baby[cur] = j
        cur = (cur * g) % p
    g_inv_m = pow(g, -m, p)
    gamma = h
    for i in range(m+1):
        if gamma in baby:
            return i * m + baby[gamma]
        gamma = (gamma * g_inv_m) % p
    return None

x = baby_step_giant_step(alpha, beta, p)
print("private key x =", x)


def decrypt_pair(c1, c2, x, p):
    s = pow(c1, x, p)         
    s_inv = pow(s, -1, p)      
    m = (c2 * s_inv) % p
    return m

ms = [decrypt_pair(a, b, x, p) for (a, b) in cipher_pairs]
print("First 10 numeric plaintext blocks:", ms[:10])

def decode_block_base26(m):
    d0 = m % 26
    m //= 26
    d1 = m % 26
    m //= 26
    d2 = m % 26
    return ''.join(chr(ord('A') + d) for d in (d2, d1, d0))

decoded = ''.join(decode_block_base26(m) for m in ms)
print("\nDecoded text (no spaces):\n")
print(decoded)